<view class="tools-page">
  <custom-navbar title="Syllaby" subtitle="Toolbox" />

  <scroll-view class="zen-scroll" scroll-y="true" enable-flex="true">
    <view class="hero-card">
      <view class="hero-content">
        <view class="hero-eyebrow">专注实验室</view>
        <view class="hero-title">Flow Studio</view>
        <view class="hero-desc">根据不同节奏切换，更快进入学习心流。</view>
        <view class="hero-stats">
          <view class="hero-stat">
            <view class="stat-label">今日专注</view>
            <view class="stat-value">{{focusStats.todayFocus || 0}} min</view>
          </view>
          <view class="hero-stat">
            <view class="stat-label">累计次数</view>
            <view class="stat-value">{{focusStats.totalSessions || 0}}</view>
          </view>
          <view class="hero-stat">
            <view class="stat-label">连续天数</view>
            <view class="stat-value">{{focusStats.streakDays || 0}}</view>
          </view>
        </view>
      </view>
      <view class="hero-action" bindtap="goToFocus">
        <view class="icon-shape timer-icon"></view>
        <text>开始专注</text>
      </view>
      <view class="background-orb orb-left"></view>
      <view class="background-orb orb-right"></view>
    </view>

    <view class="tool-section pills-section">
      <view class="section-header">
        <view>
          <view class="section-title">节奏面板</view>
          <view class="section-desc">选择一个节奏，直接进入专注页</view>
        </view>
      </view>
      <view class="pill-row">
        <view 
          class="focus-pill"
          wx:for="{{focusPills}}"
          wx:key="id"
          data-minutes="{{item.minutes}}"
          bindtap="goToPresetFocus"
        >
          <view class="pill-title">{{item.label}}</view>
          <view class="pill-desc">{{item.desc}}</view>
        </view>
      </view>
    </view>

    <view class="tool-section insights-section" wx:if="{{showStats}}">
      <view class="section-header">
        <view>
          <view class="section-title">专注概览</view>
          <view class="section-desc">自动整理的学习洞察</view>
        </view>
      </view>
      <view class="insight-list">
        <view class="insight-item" wx:for="{{insightList}}" wx:key="id">
          <view class="insight-label">{{item.label}}</view>
          <view class="insight-value">{{item.value}}</view>
          <view class="insight-hint">{{item.hint}}</view>
        </view>
      </view>
    </view>

    <view class="data-grid" wx:if="{{showStats}}">
      <view class="data-card ring-card">
        <view class="card-head">
          <view>
            <view class="card-title">全天节奏</view>
            <view class="card-desc">24 小时时段分布</view>
          </view>
        </view>
        <focus-distribution 
          data="{{distributionData}}"
          size="large"
          variant="embedded"
          bind:hourtap="onDistributionHourTap"
        ></focus-distribution>
      </view>

      <view class="data-card heat-card">
        <view class="card-head">
          <view>
            <view class="card-title">投入日历</view>
            <view class="card-desc">最近 12 个月</view>
          </view>
        </view>
        <heatmap-chart 
          data="{{heatmapData}}"
          variant="embedded"
          bind:daytap="onHeatmapDayTap"
        ></heatmap-chart>
      </view>
    </view>

    <view class="tool-section achievements-section" wx:if="{{showStats && achievements.length > 0}}">
      <view class="section-header">
        <view>
          <view class="section-title">成就徽章</view>
          <view class="section-desc">已点亮 {{achievementsMeta.unlocked}} / {{achievementsMeta.total}}</view>
        </view>
      </view>
      <scroll-view class="achievements-scroll" scroll-x="true">
        <view class="achievements-list">
          <holo-badge 
            wx:for="{{achievements}}" 
            wx:key="key"
            achievement="{{item}}"
            size="medium"
            bind:badgeTap="onBadgeTap"
          ></holo-badge>
        </view>
      </scroll-view>
    </view>

    <view class="tool-section toolkit-section">
      <view class="section-header">
        <view>
          <view class="section-title">其他工具</view>
          <view class="section-desc">资料、提醒与目标都在这里</view>
        </view>
      </view>

      <view class="tools-grid">
        <view class="tool-item" bindtap="comingSoon">
          <view class="tool-icon">
            <view class="icon-shape note-icon"></view>
          </view>
          <view class="tool-name">笔记</view>
          <view class="tool-desc">整理灵感</view>
        </view>
        <view class="tool-item" bindtap="comingSoon">
          <view class="tool-icon">
            <view class="icon-shape stats-icon"></view>
          </view>
          <view class="tool-name">学习统计</view>
          <view class="tool-desc">复盘曲线</view>
        </view>
        <view class="tool-item" bindtap="comingSoon">
          <view class="tool-icon">
            <view class="icon-shape reminder-icon"></view>
          </view>
          <view class="tool-name">提醒</view>
          <view class="tool-desc">关键待办</view>
        </view>
        <view class="tool-item" bindtap="comingSoon">
          <view class="tool-icon">
            <view class="icon-shape goal-icon"></view>
          </view>
          <view class="tool-name">学习目标</view>
          <view class="tool-desc">规划阶段</view>
        </view>
      </view>
    </view>
  </scroll-view>
</view>
