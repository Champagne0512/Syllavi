<view class="zen-container">
  <!-- å¼¥æ•£èƒŒæ™¯è£…é¥° -->
  <view class="floating-field">
    <view class="mesh-orb orb-a"></view>
    <view class="mesh-orb orb-b"></view>
    <view class="mesh-orb orb-c"></view>
    <view class="mesh-orb orb-d"></view>
  </view>

  <!-- é¡¶éƒ¨å¯¼èˆª - ç»Ÿä¸€è®¾è®¡ -->
  <custom-navbar title="Syllavi" subtitle="å­¦ä¹ ç¤¾åŒº">
    <view slot="right" class="profile-avatar" bindtap="goToProfile">
      <image wx:if="{{profile.avatar_url}}" src="{{profile.avatar_url}}" class="avatar-img"></image>
      <view wx:else class="avatar-placeholder">ğŸ‘¤</view>
    </view>
  </custom-navbar>

  <!-- æ“ä½œåŒºåŸŸ -->
  <view class="action-section">
    <!-- Tabåˆ‡æ¢ -->
    <view class="tab-switch glass">
      <view 
        class="tab-item {{currentTab === 'myGroups' ? 'active' : ''}}"
        data-tab="myGroups"
        bindtap="switchTab"
      >
        <text class="tab-text">æˆ‘çš„å°ç»„</text>
      </view>
      <view 
        class="tab-item {{currentTab === 'publicGroups' ? 'active' : ''}}"
        data-tab="publicGroups"
        bindtap="switchTab"
      >
        <text class="tab-text">å…¬å¼€å°ç»„</text>
      </view>
    </view>
    
    <!-- å¿«æ·æ“ä½œæŒ‰é’® -->
    <view class="quick-actions glass">
      <button class="action-btn primary" bindtap="createGroup">
        <text class="btn-icon">+</text>
        <text class="btn-text">åˆ›å»ºå°ç»„</text>
      </button>
      <button class="action-btn secondary" bindtap="joinGroup">
        <text class="btn-icon">ğŸ”</text>
        <text class="btn-text">å‘ç°å°ç»„</text>
      </button>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="zen-loading">
    <view class="breathing-dot"></view>
    <text class="loading-text">æ­£åœ¨åŠ è½½...</text>
  </view>

  <!-- æˆ‘çš„å°ç»„ -->
  <view wx:if="{{!loading && currentTab === 'myGroups'}}" class="content-section">
    <!-- ç©ºçŠ¶æ€ -->
    <view wx:if="{{userGroups.length === 0}}" class="zen-empty">
      <view class="empty-icon"></view>
      <view class="empty-title">å¼€å§‹ä½ çš„å­¦ä¹ ä¹‹æ—…</view>
      <view class="empty-desc">åˆ›å»ºæˆ–åŠ å…¥å­¦ä¹ å°ç»„ï¼Œä¸åŒä¼´ä¸€èµ·æˆé•¿</view>
      <view class="empty-actions">
        <button class="zen-btn primary" bindtap="createGroup">
          <text class="btn-text">åˆ›å»ºå°ç»„</text>
        </button>
        <button class="zen-btn secondary" bindtap="joinGroup">
          <text class="btn-text">å‘ç°å°ç»„</text>
        </button>
      </view>
    </view>

    <!-- å°ç»„åˆ—è¡¨ -->
    <view wx:else class="zen-group-list">
      <view class="zen-group-card" wx:for="{{userGroups}}" wx:key="group_id" data-id="{{item.group_id}}" bindtap="viewGroupDetail" catch:tap="viewGroupDetail">
        <view class="card-glow"></view>
        <view class="card-content">
          <view class="group-header">
            <view class="avatar-container">
              <image class="group-avatar" src="{{item.avatar_url || '/static/icons/group-empty.png'}}"></image>
              <view class="status-indicator {{item.member_role}}"></view>
            </view>
            <view class="group-info">
              <view class="group-name">{{item.group_name}}</view>
              <view class="group-meta">
                <view class="role-badge {{item.member_role}}">
                  <text class="role-text">{{item.member_role === 'leader' ? 'ç»„é•¿' : item.member_role === 'deputy_leader' ? 'å‰¯ç»„é•¿' : 'ç»„å‘˜'}}</text>
                </view>
                <view class="member-count">
                  <text class="count-text">{{item.member_count}}äºº</text>
                </view>
              </view>
            </view>
          </view>
          <view class="group-description">{{item.group_description || 'æš‚æ— æè¿°ï¼Œç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…'}}</view>
          <view class="group-stats">
            <view class="stat-item">
              <text class="stat-value">{{item.task_count || 0}}</text>
              <text class="stat-label">ä»»åŠ¡</text>
            </view>
            <view class="stat-divider"></view>
            <view class="stat-item">
              <text class="stat-value">{{item.resource_count || 0}}</text>
              <text class="stat-label">èµ„æ–™</text>
            </view>
            <view class="stat-divider"></view>
            <view class="stat-item">
              <text class="stat-value">{{item.active_days || 0}}</text>
              <text class="stat-label">æ´»è·ƒå¤©æ•°</text>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- å…¬å¼€å°ç»„ -->
  <view wx:if="{{!loading && currentTab === 'publicGroups'}}" class="content-section">
    <!-- ç©ºçŠ¶æ€ -->
    <view wx:if="{{publicGroups.length === 0}}" class="zen-empty">
      <view class="empty-icon"></view>
      <view class="empty-title">æš‚æ— å…¬å¼€å°ç»„</view>
      <view class="empty-desc">æˆä¸ºç¬¬ä¸€ä¸ªåˆ›å»ºå…¬å¼€å°ç»„çš„å¼•é¢†è€…</view>
      <button class="zen-btn primary" bindtap="createGroup">
        <text class="btn-text">åˆ›å»ºå°ç»„</text>
      </button>
    </view>

    <!-- å…¬å¼€å°ç»„åˆ—è¡¨ -->
    <view wx:else class="zen-group-list">
      <view class="zen-group-card" wx:for="{{publicGroups}}" wx:key="id" data-id="{{item.id}}" bindtap="viewGroupDetail">
        <view class="card-glow"></view>
        <view class="card-content">
          <view class="group-header">
            <view class="avatar-container">
              <image class="group-avatar" src="{{item.avatar_url || '/static/icons/group-empty.png'}}"></image>
              <view class="public-badge"></view>
            </view>
            <view class="group-info">
              <view class="group-name">{{item.name}}</view>
              <view class="group-meta">
                <view class="group-code">
                  <text class="code-text">{{item.group_code}}</text>
                </view>
                <view class="member-count">
                  <text class="count-text">{{item.member_count || 0}}äºº</text>
                </view>
              </view>
            </view>
          </view>
          <view class="group-description">{{item.description || 'æš‚æ— æè¿°ï¼Œç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…'}}</view>
          <view class="join-action">
            <button class="join-btn" data-code="{{item.group_code}}" bindtap="joinFromPublic" catchtap>
              <text class="join-text">ç”³è¯·åŠ å…¥</text>
            </button>
          </view>
        </view>
      </view>
    </view>
  </view>

  
</view>