<view class="focus-page" style="background-image: linear-gradient(160deg, {{gradients[gradientIndex][0]}}, {{gradients[gradientIndex][1]}});">
  <view class="floating-field">
    <view class="mesh-orb orb-a"></view>
    <view class="mesh-orb orb-b"></view>
    <view class="mesh-orb orb-c"></view>
  </view>

  <view class="focus-shell">
    <view class="top-bar">
      <view class="mood-quote">
        <text class="muted">Mood</text>
        <text class="quote">Flow stays when breathing stays.</text>
      </view>
      <button class="exit-btn" bindtap="exitFocus" wx:if="{{!running}}">✕</button>
    </view>

    <view class="course-pill" wx:if="{{courseName}}">
      <view class="pill-dot"></view>
      <text class="label">当前课程</text>
      <text class="value mono">{{courseName}}</text>
    </view>

    <view class="hero-timer">
      <view class="halo-layer outer"></view>
      <view class="halo-layer inner"></view>
      <view class="breathing-dot {{running ? 'active' : ''}}"></view>
      <text class="hero-label">Focus Window</text>
      <text class="countdown mono">{{displayTime}}</text>
      <view class="hero-meta">
        <text class="mono">{{minutes}} min session</text>
        <text class="state {{running ? 'running' : 'idle'}}">{{running ? '进行中' : '待开始'}}</text>
      </view>
    </view>

    <view class="controls-panel">
      <view class="controls">
        <button class="primary" bindtap="startFocus" disabled="{{running}}">开始专注</button>
        <button class="ghost" bindtap="stopFocus" disabled="{{!running}}">结束</button>
      </view>

      <view class="slider-block" wx:if="{{!running}}">
        <view class="slider-head">
          <text class="muted">时长 (分钟)</text>
          <text class="mono highlight">{{minutes}}</text>
        </view>
        <view class="slider-shell">
          <slider class="focus-slider" min="15" max="90" step="5" value="{{minutes}}" bindchange="adjustMinutes" />
          <view class="slider-glow"></view>
        </view>
        <view class="slider-ticks">
          <text>15</text>
          <text>30</text>
          <text>45</text>
          <text>60</text>
          <text>75</text>
          <text>90</text>
        </view>
        <view class="custom-time">
          <text class="muted small">自定义 5-180 分钟</text>
          <view class="custom-time-input">
            <input
              type="number"
              class="custom-input mono"
              value="{{customMinutesDraft}}"
              bindinput="onCustomMinutesInput"
              bindconfirm="applyCustomMinutes"
              confirm-type="done"
            />
            <text class="unit">min</text>
            <button class="apply-btn" bindtap="applyCustomMinutes">设定</button>
          </view>
        </view>
      </view>
    </view>

    <view class="summary-card" wx:if="{{summaryCard}}">
      <view class="summary-head">
        <text>专注卡片</text>
        <view class="badge">Zen Record</view>
      </view>
      <view class="summary-grid">
        <view class="summary-item">
          <text class="muted">本次专注</text>
          <text class="mono big">{{summaryCard.focus}}</text>
          <text class="unit">小时</text>
        </view>
        <view class="summary-item">
          <text class="muted">连续天数</text>
          <text class="mono big">{{summaryCard.streak}}</text>
          <text class="unit">days</text>
        </view>
      </view>
      <button class="ghost secondary" bindtap="saveCard">保存到相册</button>
    </view>
  </view>

  <canvas canvas-id="focusCard" class="focus-canvas"></canvas>
</view>
